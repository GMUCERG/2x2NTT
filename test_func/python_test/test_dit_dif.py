dif_omegas_inv_bitrev = [
    1, 10810, 5146, 8246, 11567, 10984, 8155, 6553, 8668, 9744, 8747, 3504,
    9094, 6429, 1212, 1646, 9545, 3006, 11726, 9314, 2639, 4821, 949, 9664,
    6512, 3328, 10938, 7311, 5023, 5828, 4591, 5728, 11227, 9995, 3553, 4805,
    4846, 9542, 3135, 8577, 11334, 11499, 1170, 2319, 1326, 5086, 3201, 9275,
    1635, 2768, 8034, 1177, 11563, 4611, 12149, 10436, 2963, 4896, 9238, 2366,
    11289, 4320, 3091, 12208, 2731, 3932, 7399, 6378, 6747, 12144, 3637, 3459,
    3694, 5179, 10530, 8582, 11934, 8907, 4231, 9741, 2426, 334, 10861, 10593,
    5755, 4632, 11029, 7901, 2089, 7197, 9408, 9005, 3289, 2013, 3241, 11560,
    12171, 2476, 7222, 10092, 11462, 6522, 8541, 953, 9452, 5374, 130, 4354,
    8340, 3296, 4452, 2396, 4278, 1673, 4989, 6958, 8112, 8705, 10908, 2525,
    5791, 544, 11950, 9821, 9447, 480, 11267, 12280, 8193, 11796, 9908, 6845,
    7952, 11854, 10911, 10377, 11082, 3248, 7012, 1168, 11224, 2143, 404, 4645,
    7278, 1002, 8005, 7201, 4976, 1607, 8509, 11414, 6267, 9302, 3646, 2437,
    9867, 6039, 9723, 10102, 11935, 7428, 9377, 5698, 9808, 7277, 1045, 2859,
    3778, 3833, 390, 773, 442, 9888, 1067, 7188, 545, 5019, 2678, 8585, 12047,
    1537, 8146, 7575, 5084, 1632, 11272, 4885, 3763, 1440, 9223, 12262, 9103,
    5407, 10659, 2126, 2249, 4048, 9405, 1153, 9424, 9919, 3510, 6957, 3978,
    2969, 9603, 3247, 4905, 8304, 11813, 3531, 10111, 1544, 11869, 6730, 8889,
    2399, 3136, 7098, 9289, 671, 9273, 12046, 4057, 9018, 10600, 3364, 7917,
    2174, 2847, 4414, 7247, 9984, 8236, 9644, 2780, 5195, 1484, 4895, 1426,
    4654, 1663, 10512, 2704, 6998, 3636, 4938, 10123, 8374, 12176, 7370, 3149,
    160, 7852, 12286
]
dit_omegas_inv = [
    1, 2731, 11227, 12171, 9545, 2426, 1635, 4278, 8668, 3694, 11334, 9452,
    6512, 2089, 2963, 5791, 11567, 6747, 4846, 11462, 2639, 5755, 11563, 8112,
    9094, 11934, 1326, 8340, 5023, 3289, 11289, 9447, 5146, 7399, 3553, 7222,
    11726, 10861, 8034, 4989, 8747, 10530, 1170, 130, 10938, 9408, 9238, 11950,
    8155, 3637, 3135, 8541, 949, 11029, 12149, 10908, 1212, 4231, 3201, 4452,
    4591, 3241, 3091, 11267, 10810, 3932, 9995, 2476, 3006, 334, 2768, 1673,
    9744, 5179, 11499, 5374, 3328, 7197, 4896, 544, 10984, 12144, 9542, 6522,
    4821, 4632, 4611, 8705, 6429, 8907, 5086, 3296, 5828, 2013, 4320, 480,
    8246, 6378, 4805, 10092, 9314, 10593, 1177, 6958, 3504, 8582, 2319, 4354,
    7311, 9005, 2366, 9821, 6553, 3459, 8577, 953, 9664, 7901, 10436, 2525,
    1646, 9741, 9275, 2396, 5728, 11560, 12208, 12280, 12288, 9558, 1062, 118,
    2744, 9863, 10654, 8011, 3621, 8595, 955, 2837, 5777, 10200, 9326, 6498,
    722, 5542, 7443, 827, 9650, 6534, 726, 4177, 3195, 355, 10963, 3949, 7266,
    9000, 1000, 2842, 7143, 4890, 8736, 5067, 563, 1428, 4255, 7300, 3542,
    1759, 11119, 12159, 1351, 2881, 3051, 339, 4134, 8652, 9154, 3748, 11340,
    1260, 140, 1381, 11077, 8058, 9088, 7837, 7698, 9048, 9198, 1022, 1479,
    8357, 2294, 9813, 9283, 11955, 9521, 10616, 2545, 7110, 790, 6915, 8961,
    5092, 7393, 11745, 1305, 145, 2747, 5767, 7468, 7657, 7678, 3584, 5860,
    3382, 7203, 8993, 6461, 10276, 7969, 11809, 4043, 5911, 7484, 2197, 2975,
    1696, 11112, 5331, 8785, 3707, 9970, 7935, 4978, 3284, 9923, 2468, 5736,
    8830, 3712, 11336, 2625, 4388, 1853, 9764, 10643, 2548, 3014, 9893, 6561,
    729, 81, 9
]

dit_gammas = [1, 10968, 3, 8326, 9, 400, 27, 1200, 81, 3600, 243, 10800, 729, 7822, 2187, 11177, 6561, 8953, 7394, 2281, 9893, 6843, 5101, 8240, 3014, 142, 9042, 426, 2548, 1278, 7644, 3834, 10643, 11502, 7351, 9928, 9764, 5206, 4714, 3329, 1853, 9987, 5559, 5383, 4388, 3860, 875, 11580, 2625, 10162, 7875, 5908, 11336, 5435, 9430, 4016, 3712, 12048, 11136, 11566, 8830, 10120, 1912, 5782, 5736, 5057, 4919, 2882, 2468, 8646, 7404, 1360, 9923, 4080, 5191, 12240, 3284, 12142, 9852, 11848, 4978, 10966, 2645, 8320, 7935, 382, 11516, 1146, 9970, 3438, 5332, 10314, 3707, 6364, 11121, 6803, 8785, 8120, 1777, 12071, 5331, 11635, 3704, 10327, 11112, 6403, 8758, 6920, 1696, 8471, 5088, 835, 2975, 2505, 8925, 7515, 2197, 10256, 6591, 6190, 7484, 6281, 10163, 6554, 5911, 7373, 5444, 9830, 4043, 4912, 12129, 2447, 11809, 7341, 10849, 9734, 7969, 4624, 11618, 1583, 10276, 4749, 6250, 1958, 6461, 5874, 7094, 5333, 8993, 3710, 2401, 11130, 7203, 8812, 9320, 1858, 3382, 5574, 10146, 4433, 5860, 1010, 5291, 3030, 3584, 9090, 10752, 2692, 7678, 8076, 10745, 11939, 7657, 11239, 10682, 9139, 7468, 2839, 10115, 8517, 5767, 973, 5012, 2919, 2747, 8757, 8241, 1693, 145, 5079, 435, 2948, 1305, 8844, 3915, 1954, 11745, 5862, 10657, 5297, 7393, 3602, 9890, 10806, 5092, 7840, 2987, 11231, 8961, 9115, 2305, 2767, 6915, 8301, 8456, 325, 790, 975, 2370, 2925, 7110, 8775, 9041, 1747, 2545, 5241, 7635, 3434, 10616, 10302, 7270, 6328, 9521, 6695, 3985, 7796, 11955, 11099, 11287, 8719, 9283, 1579, 3271, 4737, 9813, 1922, 4861, 5766, 2294, 5009, 6882, 2738, 8357, 8214, 493, 64, 1479, 192, 4437, 576, 1022, 1728, 3066, 5184, 9198, 3263, 3016, 9789, 9048, 4789, 2566, 2078, 7698, 6234, 10805, 6413, 7837, 6950, 11222, 8561, 9088, 1105, 2686, 3315, 8058, 9945, 11885, 5257, 11077, 3482, 8653, 10446, 1381, 6760, 4143, 7991, 140, 11684, 420, 10474, 1260, 6844, 3780, 8243, 11340, 151, 9442, 453, 3748, 1359, 11244, 4077, 9154, 12231, 2884, 12115, 8652, 11767, 1378, 10723, 4134, 7591, 113, 10484, 339, 6874, 1017, 8333, 3051, 421, 9153, 1263, 2881, 3789, 8643, 11367, 1351, 9523, 4053, 3991, 12159, 11973, 11899, 11341, 11119, 9445, 8779, 3757, 1759, 11271, 5277, 9235, 3542, 3127, 10626, 9381, 7300, 3565, 9611, 10695, 4255, 7507, 476, 10232, 1428, 6118, 4284, 6065, 563, 5906, 1689, 5429, 5067, 3998, 2912, 11994, 8736, 11404, 1630, 9634, 4890, 4324, 2381, 683, 7143, 2049, 9140, 6147, 2842, 6152, 8526, 6167, 1000, 6212, 3000, 6347, 9000, 6752, 2422, 7967, 7266, 11612, 9509, 10258, 3949, 6196, 11847, 6299, 10963, 6608, 8311, 7535, 355, 10316, 1065, 6370, 3195, 6821, 9585, 8174, 4177, 12233, 242, 12121, 726, 11785, 2178, 10777, 6534, 7753, 7313, 10970, 9650, 8332, 4372, 418, 827, 1254, 2481, 3762, 7443, 11286, 10040, 9280, 5542, 3262, 4337, 9786, 722, 4780, 2166, 2051, 6498, 6153, 7205, 6170, 9326, 6221, 3400, 6374, 10200, 6833, 6022, 8210, 5777, 52, 5042, 156, 2837, 468, 8511, 1404, 955, 4212, 2865, 347, 8595, 1041, 1207, 3123, 3621, 9369, 10863, 3529, 8011, 10587, 11744, 7183, 10654, 9260, 7384, 3202, 9863, 9606, 5011, 4240, 2744, 431, 8232, 1293, 118, 3879, 354, 11637, 1062, 10333, 3186, 6421, 9558, 6974, 4096, 8633]

dif_gammas_bitrev = [1, 1479, 4043, 7143, 5736, 4134, 1305, 722, 10643, 11077, 5860, 3195, 8785, 3542, 2545, 3621, 6561, 7698, 6461, 7266, 4978, 1351, 8961, 5777, 2625, 11340, 7468, 9650, 2975, 563, 9283, 2744, 81, 9198, 7969, 1000, 9923, 3051, 7393, 9326, 1853, 140, 7678, 726, 11112, 4255, 9521, 10654, 3014, 9088, 7203, 10963, 9970, 11119, 790, 955, 3712, 9154, 2747, 7443, 7484, 8736, 2294, 1062, 9, 1022, 11809, 2842, 2468, 339, 11745, 6498, 9764, 1381, 3584, 4177, 5331, 7300, 10616, 8011, 9893, 7837, 8993, 3949, 7935, 12159, 6915, 2837, 11336, 3748, 5767, 827, 2197, 5067, 9813, 118, 729, 9048, 10276, 9000, 3284, 2881, 5092, 10200, 4388, 1260, 7657, 6534, 1696, 1428, 11955, 9863, 2548, 8058, 3382, 355, 3707, 1759, 7110, 8595, 8830, 8652, 145, 5542, 5911, 4890, 8357, 9558, 3, 4437, 12129, 9140, 4919, 113, 3915, 2166, 7351, 8653, 5291, 9585, 1777, 10626, 7635, 10863, 7394, 10805, 7094, 9509, 2645, 4053, 2305, 5042, 7875, 9442, 10115, 4372, 8925, 1689, 3271, 8232, 243, 3016, 11618, 3000, 5191, 9153, 9890, 3400, 5559, 420, 10745, 2178, 8758, 476, 3985, 7384, 9042, 2686, 9320, 8311, 5332, 8779, 2370, 2865, 11136, 2884, 8241, 10040, 10163, 1630, 6882, 3186, 27, 3066, 10849, 8526, 7404, 1017, 10657, 7205, 4714, 4143, 10752, 242, 3704, 9611, 7270, 11744, 5101, 11222, 2401, 11847, 11516, 11899, 8456, 8511, 9430, 11244, 5012, 2481, 6591, 2912, 4861, 354, 2187, 2566, 6250, 2422, 9852, 8643, 2987, 6022, 875, 3780, 10682, 7313, 5088, 4284, 11287, 5011, 7644, 11885, 10146, 1065, 11121, 5277, 9041, 1207, 1912, 1378, 435, 4337, 5444, 2381, 493, 4096, 10968, 192, 4912, 2049, 5057, 7591, 8844, 4780, 11502, 3482, 1010, 6821, 8120, 3127, 5241, 9369, 8953, 6234, 5874, 11612, 10966, 9523, 9115, 52, 10162, 151, 2839, 8332, 2505, 5906, 1579, 431, 3600, 3263, 4624, 6212, 4080, 421, 3602, 6221, 9987, 11684, 8076, 11785, 6403, 7507, 6695, 9260, 142, 1105, 8812, 6608, 3438, 9445, 975, 4212, 12048, 12231, 8757, 11286, 6281, 11404, 5009, 10333, 400, 1728, 7341, 6152, 8646, 6874, 5862, 6153, 5206, 6760, 9090, 12233, 11635, 3565, 10302, 10587, 6843, 6950, 3710, 6196, 382, 11973, 8301, 468, 5435, 1359, 973, 1254, 10256, 3998, 1922, 3879, 7822, 4789, 4749, 6752, 12142, 3789, 7840, 6833, 3860, 6844, 11239, 7753, 8471, 6118, 11099, 9606, 1278, 9945, 5574, 10316, 6364, 11271, 8775, 1041, 10120, 11767, 5079, 3262, 7373, 4324, 8214, 6974, 8326, 576, 2447, 6147, 2882, 10484, 1954, 2051, 9928, 10446, 3030, 8174, 12071, 9381, 3434, 3529, 2281, 6413, 5333, 10258, 8320, 3991, 2767, 156, 5908, 453, 8517, 418, 7515, 5429, 4737, 1293, 10800, 9789, 1583, 6347, 12240, 1263, 10806, 6374, 5383, 10474, 11939, 10777, 6920, 10232, 7796, 3202, 426, 3315, 1858, 7535, 10314, 3757, 2925, 347, 11566, 12115, 1693, 9280, 6554, 9634, 2738, 6421, 1200, 5184, 9734, 6167, 1360, 8333, 5297, 6170, 3329, 7991, 2692, 12121, 10327, 10695, 6328, 7183, 8240, 8561, 11130, 6299, 1146, 11341, 325, 1404, 4016, 4077, 2919, 3762, 6190, 11994, 5766, 11637, 11177, 2078, 1958, 7967, 11848, 11367, 11231, 8210, 11580, 8243, 9139, 10970, 835, 6065, 8719, 4240, 3834, 5257, 4433, 6370, 6803, 9235, 1747, 3123, 5782, 10723, 2948, 9786, 9830, 683, 64, 8633]


dit_omegas = [1, 9, 81, 729, 6561, 9893, 3014, 2548, 10643, 9764, 1853, 4388, 2625, 11336, 3712, 8830, 5736, 2468, 9923, 3284, 4978, 7935, 9970, 3707, 8785, 5331, 11112, 1696, 2975, 2197, 7484, 5911, 4043, 11809, 7969, 10276, 6461, 8993, 7203, 3382, 5860, 3584, 7678, 7657, 7468, 5767, 2747, 145, 1305, 11745, 7393, 5092, 8961, 6915, 790, 7110, 2545, 10616, 9521, 11955, 9283, 9813, 2294, 8357, 1479, 1022, 9198, 9048, 7698, 7837, 9088, 8058, 11077, 1381, 140, 1260, 11340, 3748, 9154, 8652, 4134, 339, 3051, 2881, 1351, 12159, 11119, 1759, 3542, 7300, 4255, 1428, 563, 5067, 8736, 4890, 7143, 2842, 1000, 9000, 7266, 3949, 10963, 355, 3195, 4177, 726, 6534, 9650, 827, 7443, 5542, 722, 6498, 9326, 10200, 5777, 2837, 955, 8595, 3621, 8011, 10654, 9863, 2744, 118, 1062, 9558, 12288, 12280, 12208, 11560, 5728, 2396, 9275, 9741, 1646, 2525, 10436, 7901, 9664, 953, 8577, 3459, 6553, 9821, 2366, 9005, 7311, 4354, 2319, 8582, 3504, 6958, 1177, 10593, 9314, 10092, 4805, 6378, 8246, 480, 4320, 2013, 5828, 3296, 5086, 8907, 6429, 8705, 4611, 4632, 4821, 6522, 9542, 12144, 10984, 544, 4896, 7197, 3328, 5374, 11499, 5179, 9744, 1673, 2768, 334, 3006, 2476, 9995, 3932, 10810, 11267, 3091, 3241, 4591, 4452, 3201, 4231, 1212, 10908, 12149, 11029, 949, 8541, 3135, 3637, 8155, 11950, 9238, 9408, 10938, 130, 1170, 10530, 8747, 4989, 8034, 10861, 11726, 7222, 3553, 7399, 5146, 9447, 11289, 3289, 5023, 8340, 1326, 11934, 9094, 8112, 11563, 5755, 2639, 11462, 4846, 6747, 11567, 5791, 2963, 2089, 6512, 9452, 11334, 3694, 8668, 4278, 1635, 2426, 9545, 12171, 11227, 2731]

dif_omegas_bitrev = [1, 1479, 4043, 7143, 5736, 4134, 1305, 722, 10643, 11077, 5860, 3195, 8785, 3542, 2545, 3621, 6561, 7698, 6461, 7266, 4978, 1351, 8961, 5777, 2625, 11340, 7468, 9650, 2975, 563, 9283, 2744, 81, 9198, 7969, 1000, 9923, 3051, 7393, 9326, 1853, 140, 7678, 726, 11112, 4255, 9521, 10654, 3014, 9088, 7203, 10963, 9970, 11119, 790, 955, 3712, 9154, 2747, 7443, 7484, 8736, 2294, 1062, 9, 1022, 11809, 2842, 2468, 339, 11745, 6498, 9764, 1381, 3584, 4177, 5331, 7300, 10616, 8011, 9893, 7837, 8993, 3949, 7935, 12159, 6915, 2837, 11336, 3748, 5767, 827, 2197, 5067, 9813, 118, 729, 9048, 10276, 9000, 3284, 2881, 5092, 10200, 4388, 1260, 7657, 6534, 1696, 1428, 11955, 9863, 2548, 8058, 3382, 355, 3707, 1759, 7110, 8595, 8830, 8652, 145, 5542, 5911, 4890, 8357, 9558, 3, 4437, 12129, 9140, 4919, 113, 3915, 2166, 7351, 8653, 5291, 9585, 1777, 10626, 7635, 10863, 7394, 10805, 7094, 9509, 2645, 4053, 2305, 5042, 7875, 9442, 10115, 4372, 8925, 1689, 3271, 8232, 243, 3016, 11618, 3000, 5191, 9153, 9890, 3400, 5559, 420, 10745, 2178, 8758, 476, 3985, 7384, 9042, 2686, 9320, 8311, 5332, 8779, 2370, 2865, 11136, 2884, 8241, 10040, 10163, 1630, 6882, 3186, 27, 3066, 10849, 8526, 7404, 1017, 10657, 7205, 4714, 4143, 10752, 242, 3704, 9611, 7270, 11744, 5101, 11222, 2401, 11847, 11516, 11899, 8456, 8511, 9430, 11244, 5012, 2481, 6591, 2912, 4861, 354, 2187, 2566, 6250, 2422, 9852, 8643, 2987, 6022, 875, 3780, 10682, 7313, 5088, 4284, 11287, 5011, 7644, 11885, 10146, 1065, 11121, 5277, 9041, 1207, 1912, 1378, 435, 4337, 5444, 2381, 493, 4096]


# dif_omegas_inv_bitrev = [1,2,3,4]
# dit_omegas_inv = [1, 3, 2, 4]
"""// NTT DIT RN BO->NO
void ntt_dit(uint16_t *a, const uint16_t *omega)
{
    uint16_t PairsInGroup = NEWHOPE_N / 2;

    uint16_t Distance = 1;
    for (uint16_t NumOfGroups = 1; NumOfGroups < NEWHOPE_N; NumOfGroups = NumOfGroups * 2)
    {
        uint16_t GapToNextPair = 2 * NumOfGroups;
        uint16_t GapToLastPair = GapToNextPair * (PairsInGroup - 1);
        for (uint16_t k = 0; k < NumOfGroups; k++)
        {
            uint16_t Jlast = k + GapToLastPair;
            uint16_t jTwiddle = k * PairsInGroup;
            uint16_t W = omega[jTwiddle];
            for (uint16_t j = k; j <= Jlast; j += GapToNextPair)
            {
                uint16_t temp = montgomery_reduce((uint32_t) W * a[j + Distance]);
                a[j + Distance] = (a[j] - temp) % NEWHOPE_Q;
                a[j] = (a[j] + temp) % NEWHOPE_Q;
            }
        }
        PairsInGroup = PairsInGroup / 2;
        Distance = Distance * 2;
    }
}

// NTT DIF RN BO->NO
void ntt_dif(uint16_t *a, const uint16_t *omega)
{
    uint16_t NumberOfProblems = 1;

    uint16_t Distance = 1;
    for (uint16_t ProblemSize = NEWHOPE_N; ProblemSize > 1; ProblemSize = ProblemSize / 2)
    {
        for (uint16_t JFirst = 0; JFirst < NumberOfProblems; JFirst++)
        {
            uint16_t Jtwiddle = 0;
            for (uint16_t J = JFirst; J < NEWHOPE_N - 1; J += 2 * NumberOfProblems)
            {
                uint16_t W = omega[Jtwiddle++];
                uint16_t temp = a[J];
                a[J] = (temp + a[J + Distance]) % NEWHOPE_Q;
                a[J + Distance] = montgomery_reduce(((uint32_t)temp + 3 * NEWHOPE_Q - a[J + Distance]) * W);
            }
        }
        NumberOfProblems = NumberOfProblems * 2;
        Distance = Distance * 2;
    }
}
"""
NEWHOPE_N = 512
NEWHOPE_Q = 12289


# TODO: USE DIT from wiki
def ntt_dit(a, omega):
    PairsInGroup = NEWHOPE_N // 2
    NumOfGroups = 1
    Distance = 1
    while NumOfGroups < NEWHOPE_N:
        GapToNextPair = 2 * NumOfGroups
        GapToLastPair = GapToNextPair * (PairsInGroup - 1)
        for k in range(0, NumOfGroups):
            Jlast = k + GapToLastPair
            jTwiddle = k * PairsInGroup
            W = omega[jTwiddle]
            for j in range(k, Jlast+1, GapToNextPair):
                t = a[j]
                v = a[j+Distance] * W
                
                print(f"{j}-{j+Distance}: {t}, {a[j+Distance]}, {v}, [{W}]")
                print(f"{t-v}")

                a[j + Distance] = (t - v) % NEWHOPE_Q
                a[j] = (t + v) % NEWHOPE_Q
                print(f"-->{j}-{j+Distance}: {a[j]}, {a[j+Distance]}, {v}, [{W}]", end="\n\n")

        PairsInGroup //= 2
        Distance = Distance * 2
        NumOfGroups *= 2
    return a

def iterative_wiki(a, omega):
    """
    BO -> NO 
    Iteratite NTT in CHES paper
    https:////practice-project.eu//downloads//publications//ches_final.pdf
    """
    # a = bit_rev(a)

    # for s in range(logN):
    for s in range(9):
        m = 2 << s
        omega_m = NEWHOPE_N//m

        for j in range(m//2):
            omega_tmp = powmod
            for k in range(0, NEWHOPE_N, m):
                t = omega[omega_tmp] * a[k + j + m//2]
                u = a[k+j]
                a[k+j] = (u + t) % NEWHOPE_Q
                a[k+j+m//2] = (u - t ) % NEWHOPE_Q

                omega_tmp += omega_m
    return a



def ntt_dif(a, omega):
    NumberOfProblems = 1
    Distance = 1
    ProblemSize = NEWHOPE_N
    while ProblemSize > 1:
        for JFirst in range(NumberOfProblems):
            Jtwiddle = 0
            for J in range(JFirst, NEWHOPE_N - 1, 2 * NumberOfProblems):
                W = omega[Jtwiddle]
                Jtwiddle += 1
                temp = a[J]
                # print(f"{J}--{J + Distance}: {a[J]}, {a[J+Distance]}, [{W}]")
                a[J] = (temp + a[J + Distance]) % NEWHOPE_Q
                a[J + Distance] = ((temp - a[J + Distance]) * W) % NEWHOPE_Q

        NumberOfProblems *= 2
        Distance *= 2
        ProblemSize //= 2
    return a

def mul(a, gammas):
    for i in range(len(a)):
        a[i] *= gammas[i] 
        a[i] %= NEWHOPE_Q
    return a

def compare(a, b, string):
    print(string)
    assert (len(a) == len(b))
    for i in range(len(a)):
        if a[i] != b[i]:
            print(f"{a[i]} != {b[i]}")
            return False

    return True


if __name__ == "__main__":
    a = list(range(NEWHOPE_N, 0, -1))
    b = list(range(NEWHOPE_N, 0, -1))
    a = mul(a, dif_gammas_bitrev)
    a = ntt_dif(a, dif_omegas_bitrev)
    print("--------------")
    # b = ntt_dit(b, dit_omegas_inv)
    b = mul(b, dit_gammas)
    b = iterative_wiki(b, dit_omegas)

    print("DIF:", a)
    print("DIT:", b)
    compare(a, b, "DIF vs DIT")
