from gmpy2 import powmod
import random 


NEWHOPE_Q = 12289
# logQ = 14
logN = 8
NEWHOPE_N = 2**logN

# INPUT = range(NEWHOPE_N)
# INPUT = random.sample(range(NEWHOPE_Q), NEWHOPE_N)
INPUT = [10522, 5735, 260, 4983, 4541, 2047, 2176, 9041, 9751, 6154, 7447, 9852, 12135, 8328, 2920, 10957, 1736, 9491, 10997, 8188, 7043, 2652, 6038, 4620, 2775, 3278, 8142, 6327, 1102, 9512, 7665, 7516, 6490, 785, 10654, 10671, 5141, 1413, 8510, 2951, 6636, 11500, 8805, 5311, 4587, 7584, 3148, 6870, 7874, 9616, 3997, 7621, 1757, 11958, 8976, 10672, 10003, 3209, 3151, 3976, 9281, 6939, 9083, 7108, 9084, 12248, 2096, 1920, 10445, 5528, 7309, 1180, 11657, 5612, 4996, 10192, 10032, 9486, 7503, 10645, 1484, 9206, 8079, 7021, 1844, 6733, 6216, 12209, 5495, 2577, 12214, 582, 3912, 5171, 10783, 5225, 594, 5927, 10170, 4377, 6780, 1597, 5005, 9040, 12028, 2178, 7452, 9583, 4538, 6643, 958, 945, 6233, 1767, 8626, 3287, 9369, 7622, 1856, 3871, 5223, 7707, 5545, 3227, 4102, 11788, 10725, 1318, 5667, 5597, 5030, 9745, 889, 4217, 2643, 2355, 10428, 7826, 2002, 1493, 10183, 1990, 11550, 131, 2461, 8548, 11959, 4491, 3284, 7697, 1057, 6634, 554, 7113, 12138, 1235, 8908, 11920, 1459, 2915, 11149, 12036, 8957, 9179, 7224, 5726, 7734, 7605, 9363, 11460, 2240, 5211, 10441, 5900, 9746, 7565, 3580, 9912, 2124, 5000, 8830, 7400, 99, 10796, 8612, 10898, 4952, 4701, 1113, 5921, 3668, 8105, 8189, 9506, 6883, 1028, 8721, 2044, 1804, 1688, 4300, 10807, 806, 8740, 2309, 6835, 7528, 3016, 10741, 8453, 7184, 4126, 882, 1954, 2944, 11867, 4094, 2546, 3563, 2538, 3860, 3450, 5076, 6334, 3711, 3761, 5073, 4714, 6673, 7202, 7468, 7370, 4582, 11553, 11402, 9211, 9874, 817, 10748, 561, 9164, 1118, 10896, 1349, 3889, 3122, 9004, 5779, 926, 8545, 1181, 12174, 9821, 5235, 10907, 7936, 7613, 10528, 8209, 8601, 1262, 1876, 10433, 5452, 998, 6473, 11838, 1765, 10042, 7228, 11746, 10765, 12037, 11314, 630, 1573, 6934, 11595, 9882, 6215, 8325, 10644, 9896, 8269, 9652, 8937, 1816, 2639, 9681, 5915, 7780, 10488, 5776, 8314, 8398, 369, 9169, 4626, 743, 8125, 496, 6035, 3706, 6739, 2058, 8679, 9454, 2791, 4899, 7280, 4182, 5946, 1566, 11851, 6412, 9965, 9637, 9860, 10147, 7907, 3477, 5907, 2498, 985, 3890, 3745, 10795, 2619, 509, 4251, 6265, 5436, 11722, 7361, 7625, 2261, 3731, 7153, 6535, 8991, 1317, 8246, 12128, 12140, 11749, 32, 8572, 3141, 1643, 7549, 4428, 8963, 1626, 1952, 4287, 653, 9915, 5704, 141, 1475, 9621, 11832, 5516, 5304, 1611, 7861, 332, 7014, 5787, 12222, 87, 7186, 10014, 11298, 8239, 3830, 3670, 895, 4864, 8763, 10996, 192, 186, 9737, 1977, 3350, 8609, 7168, 2512, 40, 6821, 6277, 8552, 11533, 6007, 6366, 11998, 4628, 4460, 6764, 11192, 2816, 8099, 11676, 2980, 11136, 10700, 8713, 5476, 5279, 978, 9602, 12206, 290, 2708, 7732, 971, 48, 11803, 11841, 7161, 10519, 4057, 1373, 10828, 9315, 2129, 8204, 902, 4706, 12219, 1558, 6030, 3176, 2696, 3622, 6953, 5389, 3188, 9317, 7176, 8445, 2069, 6067, 6128, 3067, 8000, 1061, 10549, 9423, 9483, 7251, 2552, 7275, 9967, 6201, 4751, 1668, 2360, 7796, 3959, 10735, 2082, 2930, 10556, 5077, 8943, 6350, 6878, 1164, 778, 5162, 8528, 2900, 12158, 3424, 3598, 8430, 3352, 4586, 6974, 11503, 9440, 8351, 3721, 6310, 10308, 11712, 1391, 1714, 6860, 3064, 10109, 4796, 7413, 6626, 4543, 2814, 3381, 1352, 7825, 329, 9856, 5774, 6245, 4228, 6247, 2523, 6443, 1412, 2800, 5198, 6363, 8581, 5460, 5682, 8836, 4331, 8417, 5768, 5472, 3616, 11206, 7448, 2907, 9523, 1114, 10673, 11087, 1131, 69, 697, 2941, 2830, 3844, 8127, 8515, 9684, 3886, 613, 5434, 5333, 4972, 1350, 4510, 11094, 11845, 2651, 11565, 7545, 11461, 2154, 3955, 7409, 6943, 6920, 7346, 6375, 10435, 4283, 2724, 201, 7259, 4350, 6844, 1152, 9426, 11879, 10975, 4672, 9236, 10312, 9156, 10079, 4425, 5563, 7382, 467, 6917, 805, 6446, 9291, 11213, 2173, 8240, 3425, 259, 8881, 8437, 3591, 1639, 6359, 6131, 8673, 9251, 9717, 6309, 10860, 4763, 10304, 7227, 5981, 612, 9948, 776, 243, 2583, 398, 2416, 7399, 4275, 3022, 3079, 2402, 7384, 6827, 1964, 6454, 8364, 7272, 9389, 5060, 7135, 9973, 8678, 9829, 11140, 6465, 5429, 12211, 4876, 9357, 6295, 1953, 11263, 6668, 10743, 8060, 8988, 10928, 4165, 1517, 1679, 7646, 11335, 8919, 10629, 107, 6976, 5937, 5778, 571, 10436, 11554, 2055, 6451, 4175, 6683, 7210, 327, 7316, 5975, 4074, 9562, 2083, 7685, 5898, 9200, 3612, 7512, 3025, 2234, 4791, 9661, 11807, 1411, 9444, 2081, 11329, 11312, 7616, 10303, 6559, 3422, 3048, 540, 4412, 11127, 10873, 10021, 10761, 5887, 5972, 5805, 1443, 1733, 49, 2694, 11984, 5705, 9174, 345, 10262, 9035, 7257, 10607, 5178, 4416, 7990, 2130, 6753, 148, 4238, 5487, 5388, 3294, 5115, 5542, 11499, 4375, 2354, 2590, 2626, 5595, 7720, 4563, 1467, 5413, 4558, 6695, 12277, 5095, 10314, 7571, 2264, 12224, 125, 3280, 1703, 3527, 487, 225, 4948, 11776, 5417, 5154, 6540, 6185, 8143, 11274, 9979, 11757, 2187, 4333, 10817, 9691, 748, 8013, 11391, 2548, 4087, 8690, 7640, 1586, 3066, 11339, 11544, 4222, 11866, 4446, 2804, 7721, 3239, 4389, 2383, 7672, 2633, 2445, 7736, 11156, 2819, 10937, 2773, 8538, 2762, 3643, 6513, 2764, 8379, 6858, 5777, 1541, 4720, 1367, 3944, 1129, 8016, 362, 7546, 367, 1004, 11068, 5100, 6017, 12159, 683, 1054, 4650, 2459, 5145, 5517, 6888, 10989, 6896, 7071, 3669, 7939, 5758, 5113, 6049, 1107, 1179, 1951, 6708, 10609, 11124, 8676, 5772, 2326, 1792, 5405, 1976, 8955, 9592, 9644, 11779, 11684, 11262, 11972, 5751, 8401, 10144, 2126, 5029, 4390, 9459, 9085, 7888, 7115, 5998, 8643, 5566, 1929, 8912, 8124, 3175, 9679, 10063, 11739, 6815, 9304, 10552, 2823, 680, 383, 7418, 6314, 3929, 7756, 11016, 9409, 8, 7913, 6289, 10573, 1633, 7583, 5590, 5703, 948, 12113, 570, 6442, 11971, 12172, 3754, 10391, 8505, 9568, 7099, 10152, 4806, 3460, 8116, 2202, 11759, 942, 3502, 4519, 5276, 8579, 2853, 376, 1176, 1470, 5385, 11675, 3514, 3306, 6165, 1581, 4760, 1849, 7457, 4373, 6339, 8546, 6849, 9058, 8838, 6587, 11486, 6278, 10809, 8591, 10468, 11926, 8192, 2099, 12116, 10386, 11492, 1232, 914, 418, 77, 4692, 5556, 4166, 8518, 5832, 1492, 9532, 7836, 1215, 6122, 5657, 11036, 5122, 4951, 10317, 5503, 2134, 10288, 6342, 11891, 3488, 2670, 9595, 9796, 11575, 10516, 9335, 520, 5546, 1228, 1991, 2385, 4479, 7069, 11066, 2246, 1684, 12081, 3528, 4191, 484, 4831, 1338, 3526, 7957, 3419, 9187, 1793, 632, 11493, 4633, 5656, 8864, 5988, 8797, 2942, 4476, 11519, 11805, 10875, 2426, 9186, 12152, 7813, 4088, 1936, 11564, 8611, 10920, 2201, 5953, 3263, 5798, 3182, 11480, 2505, 5748, 1052, 3628, 6196, 7109, 3321, 9537, 10568, 7589, 7381, 2140, 6837]
INPUT = INPUT[:NEWHOPE_N]
assert len(INPUT) == NEWHOPE_N

omega = 49
omega_inv = 1254
psis = 7
psis_inv = 8778

N_inv = 12277

omega_table = [powmod(omega, i, NEWHOPE_Q) for i in range(NEWHOPE_N)]
omega_inv_table = [powmod(omega, i, NEWHOPE_Q) for i in range(NEWHOPE_N)]

psis_table = [powmod(psis, i, NEWHOPE_Q) for i in range(NEWHOPE_N)]
psis_inv_table = [powmod(psis_inv*N_inv, i, NEWHOPE_Q) for i in range(NEWHOPE_N)]
