#include "address_encoder_decoder.h"
#include "params.h"

int address_encoder(int addr_in)
{
    return addr_in;
}

/* Lazy, avoid transpose the matrix */
int address_decoder(int addr_in)
{
    /* For Inverse NTT
    [ 0  4  8 12] <= [  0* 1  2  3 ]
    [16 20 24 28] <= [  4  5  6  7 ]
    [32 36 40 44] <= [  8  9 10 11 ]
    [48 52 56 60] <= [ 12 13 14 15 ]

    [ 1  5  9 13] <= [ 16 17  18 19 ]
    [17 21 25 29] <= [ 20 21* 22 23 ]
    [33 37 41 45] <= [ 24 25  26 27 ]
    [49 53 57 61] <= [ 28 29  30 31 ]

    [ 2  6 10 14] <= [ 32 33 34  35 ]
    [18 22 26 30] <= [ 36 37 38  39 ]
    [34 38 42 46] <= [ 40 41 42* 43 ]
    [50 54 58 62] <= [ 44 45 46  47 ]

    [ 3  7 11 15] <= [ 48 49 50 51 ]
    [19 23 27 31] <= [ 52 53 54 55 ]
    [35 39 43 47] <= [ 56 57 58 59 ]
    [51 55 59 63] <= [ 60 61 62 63*] 
    */
    const int invntt_map[DILITHIUM_N / 4] = {
        0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60,
        1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61,
        2, 6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62,
        3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51, 55, 59, 63};
    return invntt_map[addr_in];
}

