#include "inttypes.h"
#include "../ref/newhope_params.h"


/* Precomputed NTT contants generated by Pari/GP script as follows:
 *
 * For n = 512:
 *
 * brv = [0,256,128,384,64,320,192,448,32,288,160,416,96,352,224,480,16,272,144,400,80,336,208,464,48,304,176,432,112,368,240,496,8,
 *        264,136,392,72,328,200,456,40,296,168,424,104,360,232,488,24,280,152,408,88,344,216,472,56,312,184,440,120,376,248,504,4,
 *        260,132,388,68,324,196,452,36,292,164,420,100,356,228,484,20,276,148,404,84,340,212,468,52,308,180,436,116,372,244,500,12,
 *        268,140,396,76,332,204,460,44,300,172,428,108,364,236,492,28,284,156,412,92,348,220,476,60,316,188,444,124,380,252,508,2,
 *        258,130,386,66,322,194,450,34,290,162,418,98,354,226,482,18,274,146,402,82,338,210,466,50,306,178,434,114,370,242,498,10,
 *        266,138,394,74,330,202,458,42,298,170,426,106,362,234,490,26,282,154,410,90,346,218,474,58,314,186,442,122,378,250,506,6,
 *        262,134,390,70,326,198,454,38,294,166,422,102,358,230,486,22,278,150,406,86,342,214,470,54,310,182,438,118,374,246,502,14,
 *        270,142,398,78,334,206,462,46,302,174,430,110,366,238,494,30,286,158,414,94,350,222,478,62,318,190,446,126,382,254,510,1,
 *        257,129,385,65,321,193,449,33,289,161,417,97,353,225,481,17,273,145,401,81,337,209,465,49,305,177,433,113,369,241,497,9,
 *        265,137,393,73,329,201,457,41,297,169,425,105,361,233,489,25,281,153,409,89,345,217,473,57,313,185,441,121,377,249,505,5,
 *        261,133,389,69,325,197,453,37,293,165,421,101,357,229,485,21,277,149,405,85,341,213,469,53,309,181,437,117,373,245,501,13,
 *        269,141,397,77,333,205,461,45,301,173,429,109,365,237,493,29,285,157,413,93,349,221,477,61,317,189,445,125,381,253,509,3,
 *        259,131,387,67,323,195,451,35,291,163,419,99,355,227,483,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,
 *        267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,
 *        263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,
 *        271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511]
 * n = 512; q = 12289; mont=2^18
 * g = Mod(10968, q);
 * omegas_inv_bitrev_montgomery = lift(vector(n/2, i, (g^2)^(-brv[2*(i-1)+1])*mont))
 * gammas_bitrev_montgomery = lift(vector(n, i, g^(brv[i])*mont))
 * gammas_inv_montgomery = lift(vector(n, i, g^(-(i-1))/n*mont))
 *
 *
 *  For n = 1024:
 *
 * brv = [0,512,256,768,128,640,384,896,64,576,320,832,192,704,448,960,32,544,288,800,160,672,416,928,96,608,352,864,224,736,480,992, \
 *        16,528,272,784,144,656,400,912,80,592,336,848,208,720,464,976,48,560,304,816,176,688,432,944,112,624,368,880,240,752,496,1008, \
 *        8,520,264,776,136,648,392,904,72,584,328,840,200,712,456,968,40,552,296,808,168,680,424,936,104,616,360,872,232,744,488,1000, \
 *        24,536,280,792,152,664,408,920,88,600,344,856,216,728,472,984,56,568,312,824,184,696,440,952,120,632,376,888,248,760,504,1016, \
 *        4,516,260,772,132,644,388,900,68,580,324,836,196,708,452,964,36,548,292,804,164,676,420,932,100,612,356,868,228,740,484,996, \
 *        20,532,276,788,148,660,404,916,84,596,340,852,212,724,468,980,52,564,308,820,180,692,436,948,116,628,372,884,244,756,500,1012, \
 *        12,524,268,780,140,652,396,908,76,588,332,844,204,716,460,972,44,556,300,812,172,684,428,940,108,620,364,876,236,748,492,1004, \
 *        28,540,284,796,156,668,412,924,92,604,348,860,220,732,476,988,60,572,316,828,188,700,444,956,124,636,380,892,252,764,508,1020, \
 *        2,514,258,770,130,642,386,898,66,578,322,834,194,706,450,962,34,546,290,802,162,674,418,930,98,610,354,866,226,738,482,994, \
 *        18,530,274,786,146,658,402,914,82,594,338,850,210,722,466,978,50,562,306,818,178,690,434,946,114,626,370,882,242,754,498,1010, \
 *        10,522,266,778,138,650,394,906,74,586,330,842,202,714,458,970,42,554,298,810,170,682,426,938,106,618,362,874,234,746,490,1002, \
 *        26,538,282,794,154,666,410,922,90,602,346,858,218,730,474,986,58,570,314,826,186,698,442,954,122,634,378,890,250,762,506,1018, \
 *        6,518,262,774,134,646,390,902,70,582,326,838,198,710,454,966,38,550,294,806,166,678,422,934,102,614,358,870,230,742,486,998, \
 *        22,534,278,790,150,662,406,918,86,598,342,854,214,726,470,982,54,566,310,822,182,694,438,950,118,630,374,886,246,758,502,1014, \
 *        14,526,270,782,142,654,398,910,78,590,334,846,206,718,462,974,46,558,302,814,174,686,430,942,110,622,366,878,238,750,494,1006, \
 *        30,542,286,798,158,670,414,926,94,606,350,862,222,734,478,990,62,574,318,830,190,702,446,958,126,638,382,894,254,766,510,1022, \
 *        1,513,257,769,129,641,385,897,65,577,321,833,193,705,449,961,33,545,289,801,161,673,417,929,97,609,353,865,225,737,481,993, \
 *        17,529,273,785,145,657,401,913,81,593,337,849,209,721,465,977,49,561,305,817,177,689,433,945,113,625,369,881,241,753,497,1009, \
 *        9,521,265,777,137,649,393,905,73,585,329,841,201,713,457,969,41,553,297,809,169,681,425,937,105,617,361,873,233,745,489,1001, \
 *        25,537,281,793,153,665,409,921,89,601,345,857,217,729,473,985,57,569,313,825,185,697,441,953,121,633,377,889,249,761,505,1017, \
 *        5,517,261,773,133,645,389,901,69,581,325,837,197,709,453,965,37,549,293,805,165,677,421,933,101,613,357,869,229,741,485,997, \
 *        21,533,277,789,149,661,405,917,85,597,341,853,213,725,469,981,53,565,309,821,181,693,437,949,117,629,373,885,245,757,501,1013, \
 *        13,525,269,781,141,653,397,909,77,589,333,845,205,717,461,973,45,557,301,813,173,685,429,941,109,621,365,877,237,749,493,1005, \
 *        29,541,285,797,157,669,413,925,93,605,349,861,221,733,477,989,61,573,317,829,189,701,445,957,125,637,381,893,253,765,509,1021, \
 *        3,515,259,771,131,643,387,899,67,579,323,835,195,707,451,963,35,547,291,803,163,675,419,931,99,611,355,867,227,739,483,995, \
 *        19,531,275,787,147,659,403,915,83,595,339,851,211,723,467,979,51,563,307,819,179,691,435,947,115,627,371,883,243,755,499,1011, \
 *        11,523,267,779,139,651,395,907,75,587,331,843,203,715,459,971,43,555,299,811,171,683,427,939,107,619,363,875,235,747,491,1003, \
 *        27,539,283,795,155,667,411,923,91,603,347,859,219,731,475,987,59,571,315,827,187,699,443,955,123,635,379,891,251,763,507,1019, \
 *        7,519,263,775,135,647,391,903,71,583,327,839,199,711,455,967,39,551,295,807,167,679,423,935,103,615,359,871,231,743,487,999, \
 *        23,535,279,791,151,663,407,919,87,599,343,855,215,727,471,983,55,567,311,823,183,695,439,951,119,631,375,887,247,759,503,1015, \
 *        15,527,271,783,143,655,399,911,79,591,335,847,207,719,463,975,47,559,303,815,175,687,431,943,111,623,367,879,239,751,495,1007, \
 *        31,543,287,799,159,671,415,927,95,607,351,863,223,735,479,991,63,575,319,831,191,703,447,959,127,639,383,895,255,767,511,1023]
 * 
 * n = 1024; q = 12289; mont=2^18
 * g = Mod(7, q);
 * omegas_inv_bitrev_montgomery = lift(vector(n/2, i, (g^2)^(-brv[2*(i-1)+1])*mont))
 * gammas_bitrev_montgomery = lift(vector(n, i, g^(brv[i])*mont))
 * gammas_inv_montgomery = lift(vector(n, i, g^(-(i-1))/n*mont))
*/


#if (NEWHOPE_N == 512)

uint16_t hls_ram2_gammas_bitrev_montgomery[NEWHOPE_N/2]={4075, 7965, 522, 9027, 2344, 1973, 1018, 11248, 7500, 5537, 8500, 5456, 5445, 4536, 6171, 2683, 10561, 6137, 5415, 6136, 5529, 56, 8724, 1702, 5339, 6093, 316, 11821, 10930, 11035, 8291, 8410, 12097, 10240, 4698, 7509, 8807, 5468, 9162, 2920, 6055, 677, 2766, 12237, 12138, 3957, 6383, 11858, 9026, 6077, 11868, 6068, 605, 504, 4782, 3029, 11184, 5681, 2844, 8077, 58, 1003, 885, 1956, 12225, 11606, 1566, 2503, 7032, 5919, 3054, 9166, 10211, 4322, 922, 4079, 4046, 1319, 6224, 8049, 7105, 6122, 3956, 6119, 4298, 168, 1594, 5106, 3728, 5990, 948, 10885, 8212, 8527, 295, 652, 11713, 6142, 1805, 10238, 1843, 4115, 2908, 8760, 5876, 2031, 8298, 12133, 11836, 11871, 6860, 10996, 2500, 5942, 11026, 5915, 1815, 1512, 2057, 9087, 8974, 4754, 8532, 11942, 174, 3009, 2655, 5868, 11796, 9908, 10911, 7952, 404, 11224, 7012, 11082, 9723, 9867, 3646, 6267, 8509, 4976, 8005, 7278, 9223, 3763, 11272, 5084, 8146, 12047, 2678, 545, 1067, 442, 390, 3778, 1045, 9808, 9377, 11935, 7852, 3149, 12176, 10123, 3636, 2704, 1663, 1426, 1484, 2780, 8236, 7247, 2847, 7917, 10600, 4057, 9273, 9289, 3136, 8889, 11869, 10111, 11813, 4905, 9603, 3978, 3510, 9424, 9405, 2249, 10659, 9103, 10810, 5146, 8155, 11567, 1212, 9094, 8747, 8668, 4591, 5023, 10938, 6512, 949, 2639, 11726, 9545, 3091, 11289, 9238, 2963, 12149, 11563, 8034, 1635, 3201, 1326, 1170, 11334, 3135, 4846, 3553, 11227, 11267, 9447, 11950, 5791, 10908, 8112, 4989, 4278, 4452, 8340, 130, 9452, 8541, 11462, 7222, 12171, 3241, 3289, 9408, 2089, 11029, 5755, 10861, 2426, 4231, 11934, 10530, 3694, 3637, 6747, 7399, 2731};
uint16_t hls_ram1_gammas_bitrev_montgomery[NEWHOPE_N/2]={5315, 7373, 10120, 5079, 1278, 5574, 6364, 8775, 7822, 4749, 12142, 7840, 3860, 11239, 8471, 11099, 400, 7341, 8646, 5862, 5206, 9090, 11635, 10302, 6843, 3710, 382, 8301, 5435, 973, 10256, 1922, 10968, 4912, 5057, 8844, 11502, 1010, 8120, 5241, 8953, 5874, 10966, 9115, 10162, 2839, 2505, 1579, 3600, 4624, 4080, 3602, 9987, 8076, 6403, 6695, 142, 8812, 3438, 975, 12048, 8757, 6281, 5009, 3656, 9830, 5782, 2948, 3834, 4433, 6803, 1747, 11177, 1958, 11848, 11231, 11580, 9139, 835, 8719, 1200, 9734, 1360, 5297, 3329, 2692, 10327, 6328, 8240, 11130, 1146, 325, 4016, 2919, 6190, 5766, 8326, 2447, 2882, 1954, 9928, 3030, 12071, 3434, 2281, 5333, 8320, 2767, 5908, 8517, 7515, 4737, 10800, 1583, 12240, 10806, 5383, 11939, 6920, 7796, 426, 1858, 10314, 2925, 11566, 1693, 6554, 2738, 8193, 5444, 1912, 435, 7644, 10146, 11121, 9041, 2187, 6250, 9852, 2987, 875, 10682, 5088, 11287, 27, 10849, 7404, 10657, 4714, 10752, 3704, 7270, 5101, 2401, 11516, 8456, 9430, 5012, 6591, 4861, 3, 12129, 4919, 3915, 7351, 5291, 1777, 7635, 7394, 7094, 2645, 2305, 7875, 10115, 8925, 3271, 243, 11618, 5191, 9890, 5559, 10745, 8758, 3985, 9042, 9320, 5332, 2370, 11136, 8241, 10163, 6882, 1, 4043, 5736, 1305, 10643, 5860, 8785, 2545, 6561, 6461, 4978, 8961, 2625, 7468, 2975, 9283, 81, 7969, 9923, 7393, 1853, 7678, 11112, 9521, 3014, 7203, 9970, 790, 3712, 2747, 7484, 2294, 9, 11809, 2468, 11745, 9764, 3584, 5331, 10616, 9893, 8993, 7935, 6915, 11336, 5767, 2197, 9813, 729, 10276, 3284, 5092, 4388, 7657, 1696, 11955, 2548, 3382, 3707, 7110, 8830, 145, 5911, 8357};
uint16_t hls_ram2_gammas_inv_montgomery[NEWHOPE_N/2]   ={512, 4267, 9615, 3205, 9261, 3087, 1029, 343, 8307, 2769, 923, 4404, 1468, 8682, 2894, 5061, 1687, 8755, 11111, 7800, 2600, 4963, 9847, 11475, 3825, 1275, 425, 4238, 5509, 10029, 3343, 9307, 11295, 3765, 1255, 8611, 11063, 7784, 6691, 10423, 11667, 3889, 9489, 3163, 9247, 11275, 11951, 8080, 10886, 7725, 2575, 9051, 3017, 5102, 5797, 10125, 3375, 1125, 375, 125, 4138, 9572, 7287, 2429, 4906, 9828, 3276, 1092, 364, 8314, 10964, 7751, 6680, 6323, 6204, 2068, 8882, 7057, 10545, 3515, 5268, 1756, 8778, 2926, 9168, 3056, 5115, 1705, 8761, 11113, 11897, 8062, 10880, 7723, 10767, 3589, 9389, 7226, 6505, 10361, 7550, 6613, 10397, 7562, 6617, 6302, 6197, 6162, 2054, 4781, 5690, 5993, 6094, 10224, 3408, 1136, 4475, 5588, 5959, 10179, 3393, 1131, 377, 4222, 9600, 3200, 5163, 1721, 4670, 5653, 10077, 3359, 5216, 5835, 1945, 8841, 2947, 9175, 11251, 11943, 3981, 1327, 8635, 11071, 11883, 3961, 9513, 3171, 1057, 8545, 11041, 11873, 8054, 6781, 10453, 11677, 12085, 12221, 8170, 10916, 7735, 10771, 11783, 8024, 6771, 2257, 8945, 7078, 10552, 11710, 12096, 4032, 1344, 448, 8342, 6877, 10485, 3495, 1165, 8581, 11053, 11877, 3959, 5416, 9998, 7429, 10669, 11749, 12109, 12229, 12269, 8186, 6825, 2275, 8951, 7080, 2360, 4883, 5724, 1908, 636, 212, 4167, 1389, 463, 8347, 10975, 11851, 12143, 8144, 6811, 10463, 7584, 2528, 4939, 9839, 7376, 6555, 2185, 8921, 7070, 6453, 2151, 717, 239, 4176, 1392, 464, 4251, 1417, 8665, 11081, 7790, 6693, 2231, 4840, 9806, 7365, 2455, 9011, 7100, 6463, 10347, 3449, 5246, 5845, 10141, 11573, 7954, 10844, 7711, 10763, 7684, 10754, 7681, 10753};
uint16_t hls_ram1_gammas_inv_montgomery[NEWHOPE_N/2]   ={3944, 5411, 5900, 6063, 2021, 4770, 1590, 530, 4273, 9617, 7302, 2434, 9004, 11194, 11924, 8071, 10883, 7724, 6671, 6320, 6203, 6164, 6151, 10243, 11607, 3869, 5386, 9988, 11522, 7937, 6742, 10440, 3480, 1160, 4483, 9687, 3229, 9269, 7186, 10588, 11722, 12100, 12226, 12268, 12282, 4094, 5461, 10013, 7434, 2478, 826, 8468, 6919, 10499, 7596, 2532, 844, 8474, 6921, 2307, 769, 8449, 11009, 7766, 6685, 10421, 7570, 10716, 3572, 5287, 9955, 11511, 3837, 1279, 8619, 2873, 5054, 5781, 1927, 8835, 2945, 5078, 5789, 6026, 6105, 2035, 8871, 2957, 5082, 1694, 4661, 5650, 10076, 7455, 2485, 9021, 3007, 9195, 3065, 5118, 1706, 4665, 1555, 8711, 7000, 10526, 7605, 2535, 845, 4378, 9652, 11410, 11996, 8095, 10891, 11823, 3941, 5410, 9996, 3332, 5207, 5832, 1944, 648, 216, 72, 24, 8, 4099, 9559, 11379, 3793, 9457, 11345, 7878, 2626, 9068, 7119, 2373, 791, 4360, 9646, 11408, 7899, 2633, 4974, 1658, 4649, 5646, 1882, 8820, 2940, 980, 4423, 9667, 11415, 3805, 9461, 7250, 6513, 2171, 4820, 5703, 1901, 4730, 5673, 1891, 8823, 2941, 9173, 7154, 6481, 10353, 3451, 9343, 11307, 3769, 9449, 7246, 10608, 3536, 5275, 9951, 3317, 5202, 1734, 578, 4289, 5526, 1842, 614, 4301, 5530, 10036, 11538, 3846, 1282, 8620, 11066, 7785, 2595, 865, 8481, 2827, 9135, 3045, 1015, 8531, 6940, 10506, 3502, 9360, 3120, 1040, 4443, 1481, 4590, 1530, 510, 170, 4153, 9577, 11385, 3795, 1265, 4518, 1506, 502, 8360, 6883, 10487, 7592, 6627, 2209, 8929, 11169, 3723, 1241, 4510, 9696, 3232, 9270, 3090, 1030, 8536, 11038, 11872, 12150, 4050, 1350, 450, 150, 50, 4113, 1371, 457};


#elif (NEWHOPE_N == 1024)


#else 
#error "NEWHOPE_N must be either 512 or 1024"
#endif
